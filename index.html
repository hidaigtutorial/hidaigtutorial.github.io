<!doctype html>
  
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My PDF Viewer</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="turn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.0.943/pdf.min.js">
    </script>
    <style>.button{
display: inline-block;
padding: 0.1em 0.5em;
border: 0.16em solid #FFFFFF;
margin: 1em 0.3em 1em 0em;
box-sizing: border-box;
text-decoration: none;
text-transform: uppercase;
font-family: 'Roboto',sans-serif;
font-weight: 400;
color: #FFFFFF;
text-align: center;
transition: all 0.15s;
background: none;
}
.button:hover{
color: #DDDDDD;
border-color: #DDDDDD;
}
@media all and (max-width: 30em){
.button{
display: block;
margin: 0.4em auto;
}
}</style>
</head>
<body style="background-color: lightskyblue">
	<div style="text-align: center">
	<div id="zoom_controls" style="display: inline-block">  
            	<button class="button" id="zoom_out">-</button>
		<button class="button" id="zoom_in">+</button>
        </div>
	<div id="navigation_controls" style="display: inline-block">
            	<button class="button" id="go_next">הבא</button>
		<button class="button" id="go_previous">הקודם</button>
        </div>
	</div>
<div id="flipbook" style="margin: auto">
    <div id="clone">
        <canvas id="pdf_renderer0"></canvas>
    </div>
</div>
<script>
   var myState = {
            pdf: null,
	    zoom: 1
        }
   pdfjsLib.getDocument('present2.pdf').then(async function(pdf) {
	myState.pdf = pdf;
       let n = pdf.numPages;
       for(var i=n; i>0; i--) {
        $("#clone").clone().appendTo("#flipbook" )
        $("#flipbook").children()[n-i+1].id = "div" + (i).toString()
        $("#flipbook").children()[n-i+1].children[0].id = "pdf_renderer" + (i).toString()
       await pdf.getPage(i).then((page) => {
           
               var canvas = document.getElementById("pdf_renderer" + (i).toString());
                var ctx = canvas.getContext('2d');
      
                var viewport = page.getViewport(1);
 
                canvas.width = viewport.width;
                canvas.height = viewport.height;
          
                page.render({
                    canvasContext: ctx,
                    viewport: viewport
                });
            });
       }
       $("#flipbook").children()[0].remove()
       	$("#flipbook").turn({
            width: 1186,
            height: 843,
            gradients: true,
            acceleration: true,
            page: n
	   });
    });
	async function render() {
		let n = myState.pdf.numPages;
		for(var i=n; i>0; i--) {
			await myState.pdf.getPage(i).then((page) => {
				var canvas = document.getElementById("pdf_renderer" + (i).toString());
				if (canvas) {
					var ctx = canvas.getContext('2d');
					var viewport = page.getViewport(myState.zoom);
					canvas.width = viewport.width;
					canvas.height = viewport.height;
					
					page.render({
						canvasContext: ctx,
						viewport: viewport
					});
				}
			});
		}
	}
	
	document.getElementById('go_previous').addEventListener('click', (e) => {
		$("#flipbook").turn("next");
	});
	document.getElementById('go_next').addEventListener('click', (e) => {
		$("#flipbook").turn("previous");
	});
	document.getElementById('zoom_in').addEventListener('click', (e) => {
            myState.zoom *= 1.1;
            $("#flipbook").turn("zoom", myState.zoom);
	    render();
        });
 
        document.getElementById('zoom_out').addEventListener('click', (e) => {
            myState.zoom /= 1.1;
            $("#flipbook").turn("zoom", myState.zoom);
            render();
        });
</script>
</body>
</html>
